description: generates fakes for interfaces using 'go generate'
name: gen-fakes
inputs:
  srcDir:
    dir:
      default: ..
      description: directory containing the projects source code
  path:
    string:
      description: relative path to file containing a 'go:generate go run github.com/maxbrunsfeld/counterfeiter/v6' pre-processing directive
outputs:
  srcDir:
    dir:
      description: directory containing the projects source code
run:
  container:
    cmd:
      - go
      - generate
      - $(path)
    dirs:
      /src: $(srcDir)
    envVars:
      GOFLAGS: -mod=vendor
    image: { ref: 'golang:1.13' }
    workDir: /src/cli
