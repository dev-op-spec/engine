name: dev
description: exposes a delv debugger for the cli
inputs:
  srcDir:
    dir:
      default: ../
run:
  container:
    image: { ref: 'golang:1.13' }
    cmd:
      - sh
      - -ce
      - go run github.com/go-delve/delve/cmd/dlv --listen=:40000 --headless=true --api-version=2 exec ./opctl
    dirs:
      /src: $(srcDir)
    envVars:
      GOFLAGS: -mod=vendor
    ports:
      # debug port for delve
      40000: 40000
    workDir: /src/cli