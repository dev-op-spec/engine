description: Runs go code generation for the CLI
name: generate
inputs:
  path:
    string:
      description: Go path spec to the file/files to generate from
      default: ./cli/...
  GOCACHE:
    dir:
      description: https://golang.org/cmd/go/#hdr-Build_and_test_caching
      default: /../../../.go/cache
  GOPATH:
    dir:
      description: https://golang.org/cmd/go/#hdr-GOPATH_environment_variable
      default: /../../../.go/path
opspec: 0.1.6
run:
  container:
    cmd:
      - go
      - generate
      - $(path)
    dirs:
      /src: $(../../..)
      /go/pkg: $(GOPATH/pkg)
      /root/.cache/go-build: $(GOCACHE)
    image: { ref: 'golang:1.15' }
    workDir: /src
